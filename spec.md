# 素数スピード練習プログラム 仕様書

## 概要
素数の掛け算で構成された数値を素因数分解するスピードを競う練習プログラム。
5問を解き終わるまでの時間を計測し、最短タイムを目指す。

## プログラム情報
- **ファイル名**: `sospeed.rb`
- **言語**: Ruby
- **実行方法**: `ruby sospeed.rb`

## ゲームルール

### 基本仕様
- **使用する素数**: 2, 3, 5, 7
- **問題数**: 5問
- **問題形式**: 上記の素数を2〜3個掛け合わせた数値を出題
- **制限時間**: なし（全問正解するまでの時間を計測）

### 問題生成ルール
- 各問題は素数を2個または3個ランダムに選択して掛け合わせて生成
- 同じ素数の重複を認める（例: 2×2×3 = 12）
- 5問すべてランダムな難易度で出題

### 入力形式
- **入力方法**: 素数をスペース区切りで入力
- **例**: `2 3 5` または `2 2 3`
- **許可される文字**: 半角数字と半角スペースのみ
- **入力順序**: 不問（`2 3 5` でも `5 2 3` でも正解）

### 正解条件
- 素因数の**種類**と**個数**が完全一致していること
- 例: 12 (2×2×3) の場合
  - ✅ 正解: `2 2 3`, `3 2 2`, `2 3 2`
  - ❌ 不正解: `2 3` (2が1つ足りない)
  - ❌ 不正解: `2 2 2 3` (2が1つ多い)
  - ❌ 不正解: `4 3` (4は素数ではない)

## エラー処理

### 1. 空白入力（Enterのみ）
- **動作**: 無視して再入力を促す
- **待機時間**: なし
- **メッセージ**: なし

### 2. 不正な文字入力
- **対象**: 半角数字と半角スペース以外の文字（全角数字、文字、記号など）
- **動作**: エラーメッセージを表示し、2秒間待機後に再入力
- **メッセージ**: `数字を入力してください`
- **待機時間**: 2秒（計測時間に含まれる）

### 3. 素因数の不一致
- **対象**: 
  - 素因数が間違っている
  - 素因数の個数が少ない
  - 素因数の個数が多い
- **動作**: エラーメッセージを表示し、2秒間待機後に再入力
- **メッセージ**: `不正解です`
- **待機時間**: 2秒（計測時間に含まれる）

## ゲームフロー

```
1. スタート画面
   ↓
2. ルール説明表示
   ↓
3. Enterキー押下でゲーム開始
   ↓
4. 計測開始
   ↓
5. 第1問〜第5問を順次出題
   各問題:
   - 数値を表示
   - プレイヤーが素因数を入力
   - 正解判定
     - 正解 → 次の問題へ
     - 不正解 → エラー処理 → 再入力
   ↓
6. 全問正解
   ↓
7. 計測終了
   ↓
8. 結果表示（合計時間）
```

## 画面表示例

### スタート画面
```
==================================================
素数スピード練習プログラム
==================================================

ルール:
- 表示された数字を素因数分解してください
- 素数をスペース区切りで入力してください(例: 2 3 5)
- 順序は問いません
- 5問すべて解くまでの時間を計測します

Enterキーを押してスタート!
```

### 問題画面
```
--------------------------------------------------
第1問: 30
--------------------------------------------------
素因数を入力 > 
```

### 正解時
```
素因数を入力 > 2 3 5
正解!
```

### 不正解時（素因数の不一致）
```
素因数を入力 > 2 5
不正解です
（2秒待機）
素因数を入力 > 
```

### 不正解時（不正な文字）
```
素因数を入力 > 2,3,5
数字を入力してください
（2秒待機）
素因数を入力 > 
```

### 結果画面
```
==================================================
お疲れ様でした!
==================================================

合計時間: 45.23秒

==================================================
```

## 技術仕様

### クラス構成
- **SoSpeed**: メインゲームクラス
  - 定数:
    - `PRIMES`: 使用する素数の配列 [2, 3, 5, 7]
    - `QUESTION_COUNT`: 問題数 (5)
    - `ERROR_WAIT_TIME`: エラー時の待機時間 (2秒)
  
  - 主要メソッド:
    - `generate_questions`: 問題を生成
    - `start`: ゲーム開始
    - `solve_question`: 1問を解く
    - `valid_input?`: 入力の検証
    - `show_result`: 結果表示

### 計測時間に含まれるもの
- 問題を読む時間
- 入力する時間
- 誤答時の待機時間（2秒）
- すべての処理時間

### 計測時間に含まれないもの
- スタート画面でEnterを押すまでの時間

## 将来の拡張案
- 難易度設定（組み合わせる素数の個数を増やす）
- 使用する素数の範囲拡大
- パターンA（1つずつ入力）の実装
- タイムランキング機能
- 統計機能（平均タイム、最短タイムなど）